/*
 MIT License

 Copyright (c) 2020 Peter Gyory & Clement Zheng

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
 */

!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("mathjs")):"function"==typeof define&&define.amd?define(["mathjs"],e):"object"==typeof exports?exports["beholder-detection"]=e(require("mathjs")):t["beholder-detection"]=e(t.mathjs)}(window,(function(t){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=33)}([function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.NO_IL=e.NO=e.MemoryStream=e.Stream=void 0;var o=r(23),s=r(25),a=o.default(s.getPolyfill()),u={};function c(){}function l(t){for(var e=t.length,r=Array(e),n=0;n<e;++n)r[n]=t[n];return r}function f(t,e,r){try{return t.f(e)}catch(t){return r._e(t),u}}e.NO=u;var h={_n:c,_e:c,_c:c};function p(t){t._start=function(t){t.next=t._n,t.error=t._e,t.complete=t._c,this.start(t)},t._stop=t.stop}e.NO_IL=h;var d=function(){function t(t,e){this._stream=t,this._listener=e}return t.prototype.unsubscribe=function(){this._stream._remove(this._listener)},t}(),m=function(){function t(t){this._listener=t}return t.prototype.next=function(t){this._listener._n(t)},t.prototype.error=function(t){this._listener._e(t)},t.prototype.complete=function(){this._listener._c()},t}(),y=function(){function t(t){this.type="fromObservable",this.ins=t,this.active=!1}return t.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new m(t)),this.active||this._sub.unsubscribe()},t.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},t}(),v=function(){function t(t){this.type="merge",this.insArr=t,this.out=u,this.ac=0}return t.prototype._start=function(t){this.out=t;var e=this.insArr,r=e.length;this.ac=r;for(var n=0;n<r;n++)e[n]._add(this)},t.prototype._stop=function(){for(var t=this.insArr,e=t.length,r=0;r<e;r++)t[r]._remove(this);this.out=u},t.prototype._n=function(t){var e=this.out;e!==u&&e._n(t)},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===u)return;t._c()}},t}(),g=function(){function t(t,e,r){this.i=t,this.out=e,this.p=r,r.ils.push(this)}return t.prototype._n=function(t){var e=this.p,r=this.out;if(r!==u&&e.up(t,this.i)){var n=l(e.vals);r._n(n)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.p;t.out!==u&&0==--t.Nc&&t.out._c()},t}(),b=function(){function t(t){this.type="combine",this.insArr=t,this.out=u,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return t.prototype.up=function(t,e){var r=this.vals[e],n=this.Nn?r===u?--this.Nn:this.Nn:0;return this.vals[e]=t,0===n},t.prototype._start=function(t){this.out=t;var e=this.insArr,r=this.Nc=this.Nn=e.length,n=this.vals=new Array(r);if(0===r)t._n([]),t._c();else for(var i=0;i<r;i++)n[i]=u,e[i]._add(new g(i,t,this))},t.prototype._stop=function(){for(var t=this.insArr,e=t.length,r=this.ils,n=0;n<e;n++)t[n]._remove(r[n]);this.out=u,this.ils=[],this.vals=[]},t}(),_=function(){function t(t){this.type="fromArray",this.a=t}return t.prototype._start=function(t){for(var e=this.a,r=0,n=e.length;r<n;r++)t._n(e[r]);t._c()},t.prototype._stop=function(){},t}(),x=function(){function t(t){this.type="fromPromise",this.on=!1,this.p=t}return t.prototype._start=function(t){var e=this;this.on=!0,this.p.then((function(r){e.on&&(t._n(r),t._c())}),(function(e){t._e(e)})).then(c,(function(t){setTimeout((function(){throw t}))}))},t.prototype._stop=function(){this.on=!1},t}(),w=function(){function t(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return t.prototype._start=function(t){var e=this;this.intervalID=setInterval((function(){t._n(e.i++)}),this.period)},t.prototype._stop=function(){-1!==this.intervalID&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},t}(),O=function(){function t(t,e){this.type="debug",this.ins=t,this.out=u,this.s=c,this.l="","string"==typeof e?this.l=e:"function"==typeof e&&(this.s=e)}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var r=this.s,n=this.l;if(r!==c)try{r(t)}catch(t){e._e(t)}else n?console.log(n+":",t):console.log(t);e._n(t)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),M=function(){function t(t,e){this.type="drop",this.ins=e,this.out=u,this.max=t,this.dropped=0}return t.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;e!==u&&this.dropped++>=this.max&&e._n(t)},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),E=function(){function t(t,e){this.out=t,this.op=e}return t.prototype._n=function(){this.op.end()},t.prototype._e=function(t){this.out._e(t)},t.prototype._c=function(){this.op.end()},t}(),j=function(){function t(t,e){this.type="endWhen",this.ins=e,this.out=u,this.o=t,this.oil=h}return t.prototype._start=function(t){this.out=t,this.o._add(this.oil=new E(t,this)),this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=u,this.oil=h},t.prototype.end=function(){var t=this.out;t!==u&&t._c()},t.prototype._n=function(t){var e=this.out;e!==u&&e._n(t)},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){this.end()},t}(),S=function(){function t(t,e){this.type="filter",this.ins=e,this.out=u,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var r=f(this,t,e);r!==u&&r&&e._n(t)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),k=function(){function t(t,e){this.out=t,this.op=e}return t.prototype._n=function(t){this.out._n(t)},t.prototype._e=function(t){this.out._e(t)},t.prototype._c=function(){this.op.inner=u,this.op.less()},t}(),A=function(){function t(t){this.type="flatten",this.ins=t,this.out=u,this.open=!0,this.inner=u,this.il=h}return t.prototype._start=function(t){this.out=t,this.open=!0,this.inner=u,this.il=h,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.inner!==u&&this.inner._remove(this.il),this.out=u,this.open=!0,this.inner=u,this.il=h},t.prototype.less=function(){var t=this.out;t!==u&&(this.open||this.inner!==u||t._c())},t.prototype._n=function(t){var e=this.out;if(e!==u){var r=this.inner,n=this.il;r!==u&&n!==h&&r._remove(n),(this.inner=t)._add(this.il=new k(e,this))}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){this.open=!1,this.less()},t}(),T=function(){function t(t,e,r){var n=this;this.type="fold",this.ins=r,this.out=u,this.f=function(e){return t(n.acc,e)},this.acc=this.seed=e}return t.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u,this.acc=this.seed},t.prototype._n=function(t){var e=this.out;if(e!==u){var r=f(this,t,e);r!==u&&e._n(this.acc=r)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),C=function(){function t(t){this.type="last",this.ins=t,this.out=u,this.has=!1,this.val=u}return t.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u,this.val=u},t.prototype._n=function(t){this.has=!0,this.val=t},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},t}(),D=function(){function t(t,e){this.type="map",this.ins=e,this.out=u,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var r=f(this,t,e);r!==u&&e._n(r)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),P=function(){function t(t){this.type="remember",this.ins=t,this.out=u}return t.prototype._start=function(t){this.out=t,this.ins._add(t)},t.prototype._stop=function(){this.ins._remove(this.out),this.out=u},t}(),N=function(){function t(t,e){this.type="replaceError",this.ins=e,this.out=u,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;e!==u&&e._n(t)},t.prototype._e=function(t){var e=this.out;if(e!==u)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(t){e._e(t)}},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),I=function(){function t(t,e){this.type="startWith",this.ins=t,this.out=u,this.val=e}return t.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},t.prototype._stop=function(){this.ins._remove(this.out),this.out=u},t}(),L=function(){function t(t,e){this.type="take",this.ins=e,this.out=u,this.max=t,this.taken=0}return t.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var r=++this.taken;r<this.max?e._n(t):r===this.max&&(e._n(t),e._c())}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),B=function(){function t(t){this._prod=t||u,this._ils=[],this._stopID=u,this._dl=u,this._d=!1,this._target=null,this._err=u}return t.prototype._n=function(t){var e=this._ils,r=e.length;if(this._d&&this._dl._n(t),1==r)e[0]._n(t);else{if(0==r)return;for(var n=l(e),i=0;i<r;i++)n[i]._n(t)}},t.prototype._e=function(t){if(this._err===u){this._err=t;var e=this._ils,r=e.length;if(this._x(),this._d&&this._dl._e(t),1==r)e[0]._e(t);else{if(0==r)return;for(var n=l(e),i=0;i<r;i++)n[i]._e(t)}if(!this._d&&0==r)throw this._err}},t.prototype._c=function(){var t=this._ils,e=t.length;if(this._x(),this._d&&this._dl._c(),1==e)t[0]._c();else{if(0==e)return;for(var r=l(t),n=0;n<e;n++)r[n]._c()}},t.prototype._x=function(){0!==this._ils.length&&(this._prod!==u&&this._prod._stop(),this._err=u,this._ils=[])},t.prototype._stopNow=function(){this._prod._stop(),this._err=u,this._stopID=u},t.prototype._add=function(t){var e=this._target;if(e)return e._add(t);var r=this._ils;if(r.push(t),!(r.length>1))if(this._stopID!==u)clearTimeout(this._stopID),this._stopID=u;else{var n=this._prod;n!==u&&n._start(this)}},t.prototype._remove=function(t){var e=this,r=this._target;if(r)return r._remove(t);var n=this._ils,i=n.indexOf(t);i>-1&&(n.splice(i,1),this._prod!==u&&n.length<=0?(this._err=u,this._stopID=setTimeout((function(){return e._stopNow()}))):1===n.length&&this._pruneCycles())},t.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},t.prototype._hasNoSinks=function(t,e){if(-1!==e.indexOf(t))return!0;if(t.out===this)return!0;if(t.out&&t.out!==u)return this._hasNoSinks(t.out,e.concat(t));if(t._ils){for(var r=0,n=t._ils.length;r<n;r++)if(!this._hasNoSinks(t._ils[r],e.concat(t)))return!1;return!0}return!1},t.prototype.ctor=function(){return this instanceof R?R:t},t.prototype.addListener=function(t){t._n=t.next||c,t._e=t.error||c,t._c=t.complete||c,this._add(t)},t.prototype.removeListener=function(t){this._remove(t)},t.prototype.subscribe=function(t){return this.addListener(t),new d(this,t)},t.prototype[a]=function(){return this},t.create=function(e){if(e){if("function"!=typeof e.start||"function"!=typeof e.stop)throw new Error("producer requires both start and stop functions");p(e)}return new t(e)},t.createWithMemory=function(t){return t&&p(t),new R(t)},t.never=function(){return new t({_start:c,_stop:c})},t.empty=function(){return new t({_start:function(t){t._c()},_stop:c})},t.throw=function(e){return new t({_start:function(t){t._e(e)},_stop:c})},t.from=function(e){if("function"==typeof e[a])return t.fromObservable(e);if("function"==typeof e.then)return t.fromPromise(e);if(Array.isArray(e))return t.fromArray(e);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.fromArray(e)},t.fromArray=function(e){return new t(new _(e))},t.fromPromise=function(e){return new t(new x(e))},t.fromObservable=function(e){if(void 0!==e.endWhen)return e;var r="function"==typeof e[a]?e[a]():e;return new t(new y(r))},t.periodic=function(e){return new t(new w(e))},t.prototype._map=function(t){return new(this.ctor())(new D(t,this))},t.prototype.map=function(t){return this._map(t)},t.prototype.mapTo=function(t){var e=this.map((function(){return t}));return e._prod.type="mapTo",e},t.prototype.filter=function(e){var r,n,i=this._prod;return new t(i instanceof S?new S((r=i.f,n=e,function(t){return r(t)&&n(t)}),i.ins):new S(e,this))},t.prototype.take=function(t){return new(this.ctor())(new L(t,this))},t.prototype.drop=function(e){return new t(new M(e,this))},t.prototype.last=function(){return new t(new C(this))},t.prototype.startWith=function(t){return new R(new I(this,t))},t.prototype.endWhen=function(t){return new(this.ctor())(new j(t,this))},t.prototype.fold=function(t,e){return new R(new T(t,e,this))},t.prototype.replaceError=function(t){return new(this.ctor())(new N(t,this))},t.prototype.flatten=function(){return new t(new A(this))},t.prototype.compose=function(t){return t(this)},t.prototype.remember=function(){return new R(new P(this))},t.prototype.debug=function(t){return new(this.ctor())(new O(this,t))},t.prototype.imitate=function(t){if(t instanceof R)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var e=this._ils,r=e.length,n=0;n<r;n++)t._add(e[n]);this._ils=[]},t.prototype.shamefullySendNext=function(t){this._n(t)},t.prototype.shamefullySendError=function(t){this._e(t)},t.prototype.shamefullySendComplete=function(){this._c()},t.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||c,t._e=t.error||c,t._c=t.complete||c,this._dl=t):(this._d=!1,this._dl=u)},t.merge=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(new v(e))},t.combine=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(new b(e))},t}();e.Stream=B;var R=function(t){function e(e){var r=t.call(this,e)||this;return r._has=!1,r}return i(e,t),e.prototype._n=function(e){this._v=e,this._has=!0,t.prototype._n.call(this,e)},e.prototype._add=function(t){var e=this._target;if(e)return e._add(t);var r=this._ils;if(r.push(t),r.length>1)this._has&&t._n(this._v);else if(this._stopID!==u)this._has&&t._n(this._v),clearTimeout(this._stopID),this._stopID=u;else if(this._has)t._n(this._v);else{var n=this._prod;n!==u&&n._start(this)}},e.prototype._stopNow=function(){this._has=!1,t.prototype._stopNow.call(this)},e.prototype._x=function(){this._has=!1,t.prototype._x.call(this)},e.prototype.map=function(t){return this._map(t)},e.prototype.mapTo=function(e){return t.prototype.mapTo.call(this,e)},e.prototype.take=function(e){return t.prototype.take.call(this,e)},e.prototype.endWhen=function(e){return t.prototype.endWhen.call(this,e)},e.prototype.replaceError=function(e){return t.prototype.replaceError.call(this,e)},e.prototype.remember=function(){return this},e.prototype.debug=function(e){return t.prototype.debug.call(this,e)},e}(B);e.MemoryStream=R;var $=B;e.default=$},function(e,r){e.exports=t},function(t,e,r){"use strict";(function(t){function r(){var e;return(e="undefined"!=typeof window?window:void 0!==t?t:this).Cyclejs=e.Cyclejs||{},(e=e.Cyclejs).adaptStream=e.adaptStream||function(t){return t},e}Object.defineProperty(e,"__esModule",{value:!0}),e.setAdapt=function(t){r().adaptStream=t},e.adapt=function(t){return r().adaptStream(t)}}).call(this,r(4))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),i=r(31);function o(t,e,r){var o,s,a,u={};if(void 0!==r?(u=e,i.array(r)?o=r:i.primitive(r)?s=r:r&&r.sel&&(o=[r])):void 0!==e&&(i.array(e)?o=e:i.primitive(e)?s=e:e&&e.sel?o=[e]:u=e),void 0!==o)for(a=0;a<o.length;++a)i.primitive(o[a])&&(o[a]=n.vnode(void 0,void 0,void 0,o[a],void 0));return"s"!==t[0]||"v"!==t[1]||"g"!==t[2]||3!==t.length&&"."!==t[3]&&"#"!==t[3]||function t(e,r,n){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==r)for(var i=0;i<r.length;++i){var o=r[i].data;void 0!==o&&t(o,r[i].children,r[i].sel)}}(u,o,t),n.vnode(t,u,o,s,void 0)}e.h=o,e.default=o},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";(function(t){var r,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:Function("return this")()).Symbol;r="function"==typeof n?n("parent"):"@@snabbdom-selector-parent",e.a=r}).call(this,r(4))},function(t,e,r){"use strict";function n(t,e,r,n,i){return{sel:t,data:e,children:r,text:n,elm:i,key:void 0===e?void 0:e.key}}Object.defineProperty(e,"__esModule",{value:!0}),e.vnode=n,e.default=n},function(t,e,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.SampleCombineOperator=e.SampleCombineListener=void 0;var i=r(0),o={},s=function(){function t(t,e){this.i=t,this.p=e,e.ils[t]=this}return t.prototype._n=function(t){var e=this.p;e.out!==o&&e.up(t,this.i)},t.prototype._e=function(t){this.p._e(t)},t.prototype._c=function(){this.p.down(this.i,this)},t}();e.SampleCombineListener=s;var a,u=function(){function t(t,e){this.type="sampleCombine",this.ins=t,this.others=e,this.out=o,this.ils=[],this.Nn=0,this.vals=[]}return t.prototype._start=function(t){this.out=t;for(var e=this.others,r=this.Nn=e.length,n=this.vals=new Array(r),i=0;i<r;i++)n[i]=o,e[i]._add(new s(i,this));this.ins._add(this)},t.prototype._stop=function(){var t=this.others,e=t.length,r=this.ils;this.ins._remove(this);for(var n=0;n<e;n++)t[n]._remove(r[n]);this.out=o,this.vals=[],this.ils=[]},t.prototype._n=function(t){var e=this.out;e!==o&&(this.Nn>0||e._n(n([t],this.vals)))},t.prototype._e=function(t){var e=this.out;e!==o&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==o&&t._c()},t.prototype.up=function(t,e){var r=this.vals[e];this.Nn>0&&r===o&&this.Nn--,this.vals[e]=t},t.prototype.down=function(t,e){this.others[t]._remove(e)},t}();e.SampleCombineOperator=u,a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return new i.Stream(new u(e,t))}},e.default=a},function(t,e,r){"use strict";function n(t,e){var r,n,i=e.elm,o=t.data.class,s=e.data.class;if((o||s)&&o!==s){for(n in s=s||{},o=o||{})s[n]||i.classList.remove(n);for(n in s)(r=s[n])!==o[n]&&i.classList[r?"add":"remove"](n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.classModule={create:n,update:n},e.default=e.classModule},function(t,e,r){"use strict";function n(t,e){var r,n,i=e.elm,o=t.data.props,s=e.data.props;if((o||s)&&o!==s){for(r in s=s||{},o=o||{})s[r]||delete i[r];for(r in s)n=s[r],o[r]===n||"value"===r&&i[r]===n||(i[r]=n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.propsModule={create:n,update:n},e.default=e.propsModule},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function n(t,e){var r,n=e.elm,i=t.data.attrs,o=e.data.attrs;if((i||o)&&i!==o){for(r in i=i||{},o=o||{}){var s=o[r];i[r]!==s&&(!0===s?n.setAttribute(r,""):!1===s?n.removeAttribute(r):120!==r.charCodeAt(0)?n.setAttribute(r,s):58===r.charCodeAt(3)?n.setAttributeNS("http://www.w3.org/XML/1998/namespace",r,s):58===r.charCodeAt(5)?n.setAttributeNS("http://www.w3.org/1999/xlink",r,s):n.setAttribute(r,s))}for(r in i)r in o||n.removeAttribute(r)}}e.attributesModule={create:n,update:n},e.default=e.attributesModule},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="undefined"!=typeof window&&window.requestAnimationFrame.bind(window)||setTimeout,i=!1;function o(t,e,r){var i;i=function(){t[e]=r},n((function(){n(i)}))}function s(t,e){var r,n,i=e.elm,s=t.data.style,a=e.data.style;if((s||a)&&s!==a){a=a||{};var u="delayed"in(s=s||{});for(n in s)a[n]||("-"===n[0]&&"-"===n[1]?i.style.removeProperty(n):i.style[n]="");for(n in a)if(r=a[n],"delayed"===n&&a.delayed)for(var c in a.delayed)r=a.delayed[c],u&&r===s.delayed[c]||o(i.style,c,r);else"remove"!==n&&r!==s[n]&&("-"===n[0]&&"-"===n[1]?i.style.setProperty(n,r):i.style[n]=r)}}e.styleModule={pre:function(){i=!1},create:s,update:s,destroy:function(t){var e,r,n=t.elm,i=t.data.style;if(i&&(e=i.destroy))for(r in e)n.style[r]=e[r]},remove:function(t,e){var r=t.data.style;if(r&&r.remove){i||(t.elm.offsetLeft,i=!0);var n,o=t.elm,s=0,a=r.remove,u=0,c=[];for(n in a)c.push(n),o.style[n]=a[n];for(var l=getComputedStyle(o)["transition-property"].split(", ");s<l.length;++s)-1!==c.indexOf(l[s])&&u++;o.addEventListener("transitionend",(function(t){t.target===o&&--u,0===u&&e()}))}else e()}},e.default=e.styleModule},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=/[A-Z]/g;function i(t,e){var r,i=e.elm,o=t.data.dataset,s=e.data.dataset;if((o||s)&&o!==s){o=o||{},s=s||{};var a=i.dataset;for(r in o)s[r]||(a?r in a&&delete a[r]:i.removeAttribute("data-"+r.replace(n,"-$&").toLowerCase()));for(r in s)o[r]!==s[r]&&(a?a[r]=s[r]:i.setAttribute("data-"+r.replace(n,"-$&").toLowerCase(),s[r]))}}e.datasetModule={create:i,update:i},e.default=e.datasetModule},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(t){this.ins=t,this.type="pairwise",this.val=null,this.has=!1,this.out=null}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.has=!1,this.out=null,this.val=null},t.prototype._n=function(t){var e=this.out;if(e)if(this.has){var r=this.val;this.val=t,e._n([r,t])}else this.val=t,this.has=!0},t.prototype._e=function(t){var e=this.out;e&&e._e(t)},t.prototype._c=function(){var t=this.out;t&&t._c()},t}();e.default=function(t){return new n.Stream(new i(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),i=r(32);function o(t,e){var r,s=void 0!==e?e:i.default;if(s.isElement(t)){var a,u=t.id?"#"+t.id:"",c=t.getAttribute("class"),l=c?"."+c.split(" ").join("."):"",f=s.tagName(t).toLowerCase()+u+l,h={},p=[],d=void 0,m=void 0,y=t.attributes,v=t.childNodes;for(d=0,m=y.length;d<m;d++)"id"!==(a=y[d].nodeName)&&"class"!==a&&(h[a]=y[d].nodeValue);for(d=0,m=v.length;d<m;d++)p.push(o(v[d],e));return n.default(f,{attrs:h},p,void 0,t)}return s.isText(t)?(r=s.getTextContent(t),n.default(void 0,void 0,void 0,r,t)):s.isComment(t)?(r=s.getTextContent(t),n.default("!",{},[],r,t)):n.default("",{},[],void 0,t)}e.toVNode=o,e.default=o},function(t,e,r){"use strict";var n=r(26),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,u=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),c=function(t,e,r,n){var i;(!(e in t)||"function"==typeof(i=n)&&"[object Function]"===o.call(i)&&n())&&(u?a(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},l=function(t,e){var r=arguments.length>2?arguments[2]:{},o=n(e);i&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)c(t,o[a],e[o[a]],r[o[a]])};l.supportsDescriptors=!!u,t.exports=l},function(t,e,r){"use strict";var n=Object.prototype.toString;t.exports=function(t){var e=n.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),r}},function(t,e,r){"use strict";"undefined"!=typeof self?t.exports=self:"undefined"!=typeof window?t.exports=window:t.exports=Function("return this")()},function(t,e,r){"use strict";(function(e){var n=r(17);t.exports=function(){return"object"==typeof e&&e&&e.Math===Math&&e.Array===Array?e:n}}).call(this,r(4))},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!l){var t=a(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new d(t,e)),1!==c.length||l||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";(function(t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if("undefined"!=typeof MutationObserver){var e=document.createTextNode(""),n=[],i=0;return new MutationObserver((function(){for(;n.length;)n.shift()()})).observe(e,{characterData:!0}),function(t){n.push(t),e.data=i=1-i}}return void 0!==t?t:void 0!==r?r.nextTick:setTimeout}}).call(this,r(29).setImmediate,r(19))},function(t,e,r){"use strict";(function(t){function n(){var e;return(e="undefined"!=typeof window?window:void 0!==t?t:this).Cyclejs=e.Cyclejs||{},(e=e.Cyclejs).adaptStream=e.adaptStream||function(t){return t},e}function i(t){return n().adaptStream(t)}r.d(e,"a",(function(){return i}))}).call(this,r(4))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(t){this.streams=t,this.type="concat",this.out=null,this.i=0}return t.prototype._start=function(t){this.out=t,this.streams[this.i]._add(this)},t.prototype._stop=function(){var t=this.streams;this.i<t.length&&t[this.i]._remove(this),this.i=0,this.out=null},t.prototype._n=function(t){var e=this.out;e&&e._n(t)},t.prototype._e=function(t){var e=this.out;e&&e._e(t)},t.prototype._c=function(){var t=this.out;if(t){var e=this.streams;e[this.i]._remove(this),++this.i<e.length?e[this.i]._add(this):t._c()}},t}();e.default=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new n.Stream(new i(t))}},function(t,e,r){t.exports=r(24)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,r=t.Symbol;if("function"==typeof r)if(r.observable)e=r.observable;else{e=r.for("https://github.com/benlesh/symbol-observable");try{r.observable=e}catch(t){}}else e="@@observable";return e}},function(t,e,r){"use strict";var n=r(15),i=r(17),o=r(18),s=r(28),a=o(),u=function(){return a};n(u,{getPolyfill:o,implementation:i,shim:s}),t.exports=u},function(t,e,r){"use strict";var n=Array.prototype.slice,i=r(16),o=Object.keys,s=o?function(t){return o(t)}:r(27),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return i(t)?a(n.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},function(t,e,r){"use strict";var n;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=r(16),a=Object.prototype.propertyIsEnumerable,u=!a.call({toString:null},"toString"),c=a.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(t){var e=t.constructor;return e&&e.prototype===t},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{f(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,r="[object Function]"===o.call(t),n=s(t),a=e&&"[object String]"===o.call(t),h=[];if(!e&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var d=c&&r;if(a&&t.length>0&&!i.call(t,0))for(var m=0;m<t.length;++m)h.push(String(m));if(n&&t.length>0)for(var y=0;y<t.length;++y)h.push(String(y));else for(var v in t)d&&"prototype"===v||!i.call(t,v)||h.push(String(v));if(u)for(var g=function(t){if("undefined"==typeof window||!p)return f(t);try{return f(t)}catch(t){return!1}}(t),b=0;b<l.length;++b)g&&"constructor"===l[b]||!i.call(t,l[b])||h.push(l[b]);return h}}t.exports=n},function(t,e,r){"use strict";var n=r(15),i=r(18);t.exports=function(){var t=i();if(n.supportsDescriptors){var e=Object.getOwnPropertyDescriptor(t,"globalThis");(!e||e.configurable&&(e.enumerable||e.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!1})}else"object"==typeof globalThis&&globalThis===t||(t.globalThis=t);return t}},function(t,e,r){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},r(30),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,r(4))},function(t,e,r){(function(t,e){!function(t,r){"use strict";if(!t.setImmediate){var n,i,o,s,a,u=1,c={},l=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},n=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,n=function(t){var e=f.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):n=function(t){setTimeout(d,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&d(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),n=function(e){t.postMessage(s+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var i={callback:t,args:e};return c[u]=i,n(u),u++},h.clearImmediate=p}function p(t){delete c[t]}function d(t){if(l)setTimeout(d,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(void 0,r)}}(e)}finally{p(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,r(4),r(19))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.array=Array.isArray,e.primitive=function(t){return"string"==typeof t||"number"==typeof t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.htmlDomApi={createElement:function(t){return document.createElement(t)},createElementNS:function(t,e){return document.createElementNS(t,e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,r){t.insertBefore(e,r)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return 1===t.nodeType},isText:function(t){return 3===t.nodeType},isComment:function(t){return 8===t.nodeType}},e.default=e.htmlDomApi},function(t,e,r){"use strict";r.r(e),r.d(e,"update",(function(){return We})),r.d(e,"init",(function(){return Ve})),r.d(e,"getAllMarkers",(function(){return He})),r.d(e,"getMarker",(function(){return Xe})),r.d(e,"getMarkerPair",(function(){return Ke}));var n=r(0),i=r.n(n),o=r(13),s=r.n(o),a=r(20),u=r.n(a),c=r(21);function l(t){return 0===Object.keys(t).length}function f(t,e){if("function"!=typeof t)throw new Error("First argument given to Cycle must be the 'main' function.");if("object"!=typeof e||null===e)throw new Error("Second argument given to Cycle must be an object with driver functions as properties.");if(l(e))throw new Error("Second argument given to Cycle must be an object with at least one driver function declared as a property.");var r=function(t){if("object"!=typeof t||null===t)throw new Error("Argument given to setupReusable must be an object with driver functions as properties.");if(l(t))throw new Error("Argument given to setupReusable must be an object with at least one driver function declared as a property.");var e=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=i.a.create());return e}(t),r=function(t){for(var e in t)t.hasOwnProperty(e)&&t[e]&&"function"==typeof t[e].shamefullySendNext&&(t[e]=Object(c.a)(t[e]));return t}(function(t,e){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n](e[n],n),r[n]&&"object"==typeof r[n]&&(r[n]._isCycleSource=n));return r}(t,e));return{sources:r,run:function(t){return function(t,e){var r=u()(),n=Object.keys(t).filter((function(t){return!!e[t]})),o={},s={};n.forEach((function(t){o[t]={_n:[],_e:[]},s[t]={next:function(e){return o[t]._n.push(e)},error:function(e){return o[t]._e.push(e)},complete:function(){}}}));var a=n.map((function(e){return i.a.fromObservable(t[e]).subscribe(s[e])}));return n.forEach((function(t){var n=e[t],i=function(t){r((function(){return n._n(t)}))},a=function(t){r((function(){(console.error||console.log)(t),n._e(t)}))};o[t]._n.forEach(i),o[t]._e.forEach(a),s[t].next=i,s[t].error=a,s[t]._n=i,s[t]._e=a})),o=null,function(){a.forEach((function(t){return t.unsubscribe()}))}}(t,e)},dispose:function(){!function(t){for(var e in t)t.hasOwnProperty(e)&&t[e]&&t[e].dispose&&t[e].dispose()}(r),function(t){Object.keys(t).forEach((function(e){return t[e]._c()}))}(e)}}}(e),n=t(r.sources);return"undefined"!=typeof window&&(window.Cyclejs=window.Cyclejs||{},window.Cyclejs.sinks=n),{sinks:n,sources:r.sources,run:function(){var t=r.run(n);return function(){t(),r.dispose()}}}}function h(t,e){var r=f(t,e);return"undefined"!=typeof window&&window.CyclejsDevTool_startGraphSerializer&&window.CyclejsDevTool_startGraphSerializer(r.sinks),r.run()}var p=r(3);var d=r(2);function m(t,e,r,i,o){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!1);var s=null;return n.Stream.create({start:function(n){s=i?function(t){y(t,i),n.next(t)}:function(t){n.next(t)},t.addEventListener(e,s,{capture:r,passive:o})},stop:function(){t.removeEventListener(e,s,r),s=null}})}function y(t,e){if(e)if("boolean"==typeof e)t.preventDefault();else if("function"==typeof e)e(t)&&t.preventDefault();else{if("object"!=typeof e)throw new Error("preventDefault has to be either a boolean, predicate function or object");(function t(e,r){for(var n=Object.keys(e),i=n.length,o=0;o<i;o++){var s=n[o];if("object"==typeof e[s]&&"object"==typeof r[s]){if(!t(e[s],r[s]))return!1}else if(e[s]!==r[s])return!1}return!0})(e,t)&&t.preventDefault()}}var v=function(){function t(t){this._name=t}return t.prototype.select=function(t){return this},t.prototype.elements=function(){var t=Object(d.adapt)(i.a.of([document]));return t._isCycleSource=this._name,t},t.prototype.element=function(){var t=Object(d.adapt)(i.a.of(document));return t._isCycleSource=this._name,t},t.prototype.events=function(t,e,r){var n;void 0===e&&(e={}),n=m(document,t,e.useCapture,e.preventDefault);var i=Object(d.adapt)(n);return i._isCycleSource=this._name,i},t}(),g=function(){function t(t){this._name=t}return t.prototype.select=function(t){return this},t.prototype.elements=function(){var t=Object(d.adapt)(i.a.of([document.body]));return t._isCycleSource=this._name,t},t.prototype.element=function(){var t=Object(d.adapt)(i.a.of(document.body));return t._isCycleSource=this._name,t},t.prototype.events=function(t,e,r){var n;void 0===e&&(e={}),n=m(document.body,t,e.useCapture,e.preventDefault);var i=Object(d.adapt)(n);return i._isCycleSource=this._name,i},t}();function b(t){if("string"!=typeof t&&(e=t,!("object"==typeof HTMLElement?e instanceof HTMLElement||e instanceof DocumentFragment:e&&"object"==typeof e&&null!==e&&(1===e.nodeType||11===e.nodeType)&&"string"==typeof e.nodeName)))throw new Error("Given container is not a DOM element neither a selector string.");var e}function _(t){for(var e="",r=t.length-1;r>=0&&"selector"===t[r].type;r--)e=t[r].scope+" "+e;return e.trim()}function x(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==e[r].type||t[r].scope!==e[r].scope)return!1;return!0}var w=function(){function t(t,e){this.namespace=t,this.isolateModule=e,this._namespace=t.filter((function(t){return"selector"!==t.type}))}return t.prototype.isDirectlyInScope=function(t){var e=this.isolateModule.getNamespace(t);if(!e)return!1;if(this._namespace.length>e.length||!x(this._namespace,e.slice(0,this._namespace.length)))return!1;for(var r=this._namespace.length;r<e.length;r++)if("total"===e[r].type)return!1;return!0},t}();var O=function(){function t(t,e){this.namespace=t,this.isolateModule=e}return t.prototype.call=function(){var t,e=this.namespace,r=_(e),n=new w(e,this.isolateModule),i=this.isolateModule.getElement(e.filter((function(t){return"selector"!==t.type})));return void 0===i?[]:""===r?[i]:(t=i.querySelectorAll(r),Array.prototype.slice.call(t)).filter(n.isDirectlyInScope,n).concat(i.matches(r)?[i]:[])},t}(),M=function(){return(M=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function E(t){return{type:(e=t,e.length>1&&("."===e[0]||"#"===e[0])?"sibling":"total"),scope:t};var e}var j=function(){function t(e,r,n,i,o,s){var a;void 0===n&&(n=[]),this._rootElement$=e,this._sanitation$=r,this._namespace=n,this._isolateModule=i,this._eventDelegator=o,this._name=s,this.isolateSource=function(e,r){return new t(e._rootElement$,e._sanitation$,e._namespace.concat(E(r)),e._isolateModule,e._eventDelegator,e._name)},this.isolateSink=(a=this._namespace,function(t,e){return":root"===e?t:t.map((function(t){if(!t)return t;var r=E(e),n=M({},t,{data:M({},t.data,{isolate:t.data&&Array.isArray(t.data.isolate)?t.data.isolate:a.concat([r])})});return M({},n,{key:void 0!==n.key?n.key:JSON.stringify(n.data.isolate)})}))})}return t.prototype._elements=function(){if(0===this._namespace.length)return this._rootElement$.map((function(t){return[t]}));var t=new O(this._namespace,this._isolateModule);return this._rootElement$.map((function(){return t.call()}))},t.prototype.elements=function(){var t=Object(d.adapt)(this._elements().remember());return t._isCycleSource=this._name,t},t.prototype.element=function(){var t=Object(d.adapt)(this._elements().filter((function(t){return t.length>0})).map((function(t){return t[0]})).remember());return t._isCycleSource=this._name,t},Object.defineProperty(t.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),t.prototype.select=function(e){if("string"!=typeof e)throw new Error("DOM driver's select() expects the argument to be a string as a CSS selector");if("document"===e)return new v(this._name);if("body"===e)return new g(this._name);var r=":root"===e?[]:this._namespace.concat({type:"selector",scope:e.trim()});return new t(this._rootElement$,this._sanitation$,r,this._isolateModule,this._eventDelegator,this._name)},t.prototype.events=function(t,e,r){if(void 0===e&&(e={}),"string"!=typeof t)throw new Error("DOM driver's events() expects argument to be a string representing the event type to listen for.");var n=this._eventDelegator.addEventListener(t,this._namespace,e,r),i=Object(d.adapt)(n);return i._isCycleSource=this._name,i},t.prototype.dispose=function(){this._sanitation$.shamefullySendNext(null)},t}();function S(t,e,r,n,i){return{sel:t,data:e,children:r,text:n,elm:i,key:void 0===e?void 0:e.key}}var k=S,A=Array.isArray;function T(t){return"string"==typeof t||"number"==typeof t}var C={createElement:function(t){return document.createElement(t)},createElementNS:function(t,e){return document.createElementNS(t,e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,r){t.insertBefore(e,r)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return 1===t.nodeType},isText:function(t){return 3===t.nodeType},isComment:function(t){return 8===t.nodeType}};function D(t){return void 0===t}function P(t){return void 0!==t}var N=k("",{},[],void 0,void 0);function I(t,e){return t.key===e.key&&t.sel===e.sel}function L(t,e,r){var n,i,o,s={};for(n=e;n<=r;++n)null!=(o=t[n])&&void 0!==(i=o.key)&&(s[i]=n);return s}var B=["create","update","remove","destroy","pre","post"];function R(t,e){var r,n,i={},o=void 0!==e?e:C;for(r=0;r<B.length;++r)for(i[B[r]]=[],n=0;n<t.length;++n){var s=t[n][B[r]];void 0!==s&&i[B[r]].push(s)}function a(t,e){return function(){if(0==--e){var r=o.parentNode(t);o.removeChild(r,t)}}}function u(t,e){var r,n=t.data;void 0!==n&&P(r=n.hook)&&P(r=r.init)&&(r(t),n=t.data);var s=t.children,a=t.sel;if("!"===a)D(t.text)&&(t.text=""),t.elm=o.createComment(t.text);else if(void 0!==a){var c=a.indexOf("#"),l=a.indexOf(".",c),f=c>0?c:a.length,h=l>0?l:a.length,p=-1!==c||-1!==l?a.slice(0,Math.min(f,h)):a,d=t.elm=P(n)&&P(r=n.ns)?o.createElementNS(r,p):o.createElement(p);for(f<h&&d.setAttribute("id",a.slice(f+1,h)),l>0&&d.setAttribute("class",a.slice(h+1).replace(/\./g," ")),r=0;r<i.create.length;++r)i.create[r](N,t);if(A(s))for(r=0;r<s.length;++r){var m=s[r];null!=m&&o.appendChild(d,u(m,e))}else T(t.text)&&o.appendChild(d,o.createTextNode(t.text));P(r=t.data.hook)&&(r.create&&r.create(N,t),r.insert&&e.push(t))}else t.elm=o.createTextNode(t.text);return t.elm}function c(t,e,r,n,i,s){for(;n<=i;++n){var a=r[n];null!=a&&o.insertBefore(t,u(a,s),e)}}function l(t){var e,r,n=t.data;if(void 0!==n){for(P(e=n.hook)&&P(e=e.destroy)&&e(t),e=0;e<i.destroy.length;++e)i.destroy[e](t);if(void 0!==t.children)for(r=0;r<t.children.length;++r)null!=(e=t.children[r])&&"string"!=typeof e&&l(e)}}function f(t,e,r,n){for(;r<=n;++r){var s=void 0,u=void 0,c=void 0,f=e[r];if(null!=f)if(P(f.sel)){for(l(f),u=i.remove.length+1,c=a(f.elm,u),s=0;s<i.remove.length;++s)i.remove[s](f,c);P(s=f.data)&&P(s=s.hook)&&P(s=s.remove)?s(f,c):c()}else o.removeChild(t,f.elm)}}function h(t,e,r){var n,s;P(n=e.data)&&P(s=n.hook)&&P(n=s.prepatch)&&n(t,e);var a=e.elm=t.elm,l=t.children,p=e.children;if(t!==e){if(void 0!==e.data){for(n=0;n<i.update.length;++n)i.update[n](t,e);P(n=e.data.hook)&&P(n=n.update)&&n(t,e)}D(e.text)?P(l)&&P(p)?l!==p&&function(t,e,r,n){for(var i,s,a,l=0,p=0,d=e.length-1,m=e[0],y=e[d],v=r.length-1,g=r[0],b=r[v];l<=d&&p<=v;)null==m?m=e[++l]:null==y?y=e[--d]:null==g?g=r[++p]:null==b?b=r[--v]:I(m,g)?(h(m,g,n),m=e[++l],g=r[++p]):I(y,b)?(h(y,b,n),y=e[--d],b=r[--v]):I(m,b)?(h(m,b,n),o.insertBefore(t,m.elm,o.nextSibling(y.elm)),m=e[++l],b=r[--v]):I(y,g)?(h(y,g,n),o.insertBefore(t,y.elm,m.elm),y=e[--d],g=r[++p]):(void 0===i&&(i=L(e,l,d)),D(s=i[g.key])?(o.insertBefore(t,u(g,n),m.elm),g=r[++p]):((a=e[s]).sel!==g.sel?o.insertBefore(t,u(g,n),m.elm):(h(a,g,n),e[s]=void 0,o.insertBefore(t,a.elm,m.elm)),g=r[++p]));(l<=d||p<=v)&&(l>d?c(t,null==r[v+1]?null:r[v+1].elm,r,p,v,n):f(t,e,l,d))}(a,l,p,r):P(p)?(P(t.text)&&o.setTextContent(a,""),c(a,null,p,0,p.length-1,r)):P(l)?f(a,l,0,l.length-1):P(t.text)&&o.setTextContent(a,""):t.text!==e.text&&(P(l)&&f(a,l,0,l.length-1),o.setTextContent(a,e.text)),P(s)&&P(n=s.postpatch)&&n(t,e)}}return function(t,e){var r,n,s,a=[];for(r=0;r<i.pre.length;++r)i.pre[r]();for(function(t){return void 0!==t.sel}(t)||(t=function(t){var e=t.id?"#"+t.id:"",r=t.className?"."+t.className.split(" ").join("."):"";return k(o.tagName(t).toLowerCase()+e+r,{},[],void 0,t)}(t)),I(t,e)?h(t,e,a):(n=t.elm,s=o.parentNode(n),u(e,a),null!==s&&(o.insertBefore(s,e.elm,o.nextSibling(n)),f(s,[t],0,0))),r=0;r<a.length;++r)a[r].data.hook.insert(a[r]);for(r=0;r<i.post.length;++r)i.post[r]();return e}}var $=r(22),F=r.n($),W=r(7),z=r.n(W),G=r(14),U=r(6);var q=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},V="[ \t]*",H="(?:=|\\$=|\\^=|\\*=|~=|\\|=)",X="(?:(?:[ \t]+)|(?:[ \t]*(>)[ \t]*)|(?:[ \t]*(\\+)[ \t]*)|(?:[ \t]*(~)[ \t]*))",K=new RegExp("^"+X+"$");function Z(t){var e=t.trim(),r=new RegExp("(:?[\\w-]+)?","y"),n=r.exec(e)[0],i=new RegExp('(?:\\.[\\w-]+)|(?:#[\\w-]+)|(?:\\[[ \t]*[\\w-]+[ \t]*(?:(?:=|\\$=|\\^=|\\*=|~=|\\|=)[ \t]*[^\\]]+[ \t]*)?\\])|:(?:first-child|last-child|nth-child\\((?:even|odd|\\d*(?:-?n(?:\\+\\d+)?)?)\\)|empty|root|contains\\("[^"]*"\\))|(?:(?:[ \t]+)|(?:[ \t]*(>)[ \t]*)|(?:[ \t]*(\\+)[ \t]*)|(?:[ \t]*(~)[ \t]*))',"y");i.lastIndex=r.lastIndex;for(var o=[],s=void 0,a=void 0,u=-1;i.lastIndex<e.length;){var c=i.exec(e);if(!c&&void 0===a)throw new Error("Parse error, invalid selector");if(c&&K.test(c[0])){a=K.exec(c[0])[0],u=i.lastIndex}else{if(void 0!==a){s=[Q(a),Z(e.substring(u))];break}o.push(c[0])}}var l=o.filter((function(t){return t.startsWith(".")})).map((function(t){return t.substring(1)})),f=o.filter((function(t){return t.startsWith("#")})).map((function(t){return t.substring(1)}));if(f.length>1)throw new Error("Invalid selector, only one id is allowed");var h=new RegExp("([\\w-]+)[ \t]*("+H+")?"+V+"([^\\]]+)?"),p=o.filter((function(t){return t.startsWith("[")})).map((function(t){return h.exec(t).slice(1,4)})).map((function(t){var e,r=t[0],n=t[1],i=t[2];return(e={})[r]=[J(n),i?Y(i):i],e})).reduce((function(t,e){return q({},t,e)}),{}),d=o.filter((function(t){return t.startsWith(":")})).map((function(t){return function(t){if("first-child"===t||"last-child"===t||"root"===t||"empty"===t)return[t,void 0];if(t.startsWith("contains")){return["contains",t.slice(10,-2)]}var e=t.slice(10,-1);"even"===e&&(e="2n");"odd"===e&&(e="2n+1");return["nth-child",e]}(t.substring(1))}));return{id:f[0]||"",tag:n,classList:l,attributes:p,nextSelector:s,pseudos:d}}function Y(t){if(t.startsWith('"'))return t.slice(1,-1);if("true"===t)return!0;if("false"===t)return!1;var e=parseFloat(t);return isNaN(e)?t:e}function J(t){switch(t){case"=":return"exact";case"^=":return"startsWith";case"$=":return"endsWith";case"*=":return"contains";case"~=":return"whitespace";case"|=":return"dash";default:return"has"}}function Q(t){switch(t.trim()){case">":return"child";case"+":return"nextSibling";case"~":return"sibling";default:return"subtree"}}function tt(t){return function(e,r){var n="object"==typeof e?e:Z(e),i=n.tag,o=n.id,s=n.classList,a=n.attributes,u=n.nextSelector,c=n.pseudos;if(void 0!==u)throw new Error("matches can only process selectors that target a single element");if(!r)return!1;if(i&&i.toLowerCase()!==t.tag(r).toLowerCase())return!1;if(o&&o!==t.id(r))return!1;for(var l=t.className(r).split(" "),f=0;f<s.length;f++)if(-1===l.indexOf(s[f]))return!1;for(var h in a){var p=t.attr(r,h),d=a[h][0],m=a[h][1];if(void 0===p)return!1;if("has"===d)return!0;if("exact"===d&&p!==m)return!1;if("exact"!==d){if("string"!=typeof m)throw new Error("All non-string values have to be an exact match");if("startsWith"===d&&!p.startsWith(m))return!1;if("endsWith"===d&&!p.endsWith(m))return!1;if("contains"===d&&-1===p.indexOf(m))return!1;if("whitespace"===d&&-1===p.split(" ").indexOf(m))return!1;if("dash"===d&&-1===p.split("-").indexOf(m))return!1}}for(f=0;f<c.length;f++){var y=c[f],v=(d=y[0],y[1]);if("contains"===d&&v!==t.contents(r))return!1;if("empty"===d&&(t.contents(r)||0!==t.children(r).length))return!1;if("root"===d&&void 0!==t.parent(r))return!1;if(-1!==d.indexOf("child")){if(!t.parent(r))return!1;var g=t.children(t.parent(r));if("first-child"===d&&0!==g.indexOf(r))return!1;if("last-child"===d&&g.indexOf(r)!==g.length-1)return!1;if("nth-child"===d){var b=/([\+-]?)(\d*)(n?)(\+\d+)?/.exec(v).slice(1),_=g.indexOf(r);b[0]||(b[0]="+");var x=b[1]?parseInt(b[0]+b[1]):void 0,w=parseInt(b[3]||"0");if(x&&"n"===b[2]&&_%x!==w)return!1;if(!x&&b[2]&&("+"===b[0]&&_-w<0||"-"===b[0]&&_-w>=0))return!1;if(!b[2]&&x&&_!==x-1)return!1}}}return!0}}function et(t){if(!t.sel)return{tagName:"",id:"",className:""};var e=t.sel,r=e.indexOf("#"),n=e.indexOf(".",r),i=r>0?r:e.length,o=n>0?n:e.length;return{tagName:-1!==r||-1!==n?e.slice(0,Math.min(i,o)):e,id:i<o?e.slice(i+1,o):void 0,className:n>0?e.slice(o+1).replace(/\./g," "):void 0}}function rt(t){var e=et(t).className,r=void 0===e?"":e;if(!t.data)return r;var n=t.data,i=n.class,o=n.props;i&&(r+=" "+Object.keys(i).filter((function(t){return i[t]})).join(" "));return o&&o.className&&(r+=" "+o.className),r&&r.trim()}var nt=r(5),it={tag:function(t){return et(t).tagName},className:function(t){return rt(t)},id:function(t){return et(t).id||""},children:function(t){return t.children||[]},parent:function(t){return t.data[nt.a]||t},contents:function(t){return t.text||""},attr:function(t,e){if(t.data){var r=t.data,n=r.attrs,i=void 0===n?{}:n,o=r.props,s=void 0===o?{}:o,a=r.dataset,u=void 0===a?{}:a;if(i[e])return i[e];if(s[e])return s[e];if(0===e.indexOf("data-")&&u[e.slice(5)])return u[e.slice(5)]}}},ot=tt(it);var st,at;st=it,at=function(t,e){var r=e.data,n=ot.bind(null,t);if(r&&r.fn){var i=void 0;return!!n(i=Array.isArray(r.args)?r.fn.apply(null,r.args):r.args?r.fn.call(null,r.args):r.fn())&&i}return n(e)}||tt(st);var ut=function(){function t(t){this.rootElement=t}return t.prototype.call=function(t){if(11===this.rootElement.nodeType)return this.wrapDocFrag(null===t?[]:[t]);if(null===t)return this.wrap([]);var e=et(t),r=e.tagName,n=e.id,i=rt(t),o=((t.data||{}).props||{}).id,s=void 0===o?n:o;return"string"==typeof s&&s.toUpperCase()===this.rootElement.id.toUpperCase()&&r.toUpperCase()===this.rootElement.tagName.toUpperCase()&&i.toUpperCase()===this.rootElement.className.toUpperCase()?t:this.wrap([t])},t.prototype.wrapDocFrag=function(t){return Object(U.vnode)("",{isolate:[]},t,void 0,this.rootElement)},t.prototype.wrap=function(t){var e=this.rootElement,r=e.tagName,n=e.id,i=e.className,o=n?"#"+n:"",s=i?"."+i.split(" ").join("."):"",a=Object(p.h)(""+r.toLowerCase()+o+s,{},t);return a.data=a.data||{},a.data.isolate=a.data.isolate||[],a},t}(),ct=r(8),lt=r.n(ct),ft=r(9),ht=r.n(ft),pt=r(10),dt=r.n(pt),mt=r(11),yt=r.n(mt),vt=r(12),gt=r.n(vt),bt=[yt.a,lt.a,ht.a,dt.a,gt.a],_t=function(){function t(t){this.mapper=t,this.tree=[void 0,{}]}return t.prototype.set=function(t,e,r){for(var n=this.tree,i=void 0!==r?r:t.length,o=0;o<i;o++){var s=this.mapper(t[o]),a=n[1][s];a||(a=[void 0,{}],n[1][s]=a),n=a}n[0]=e},t.prototype.getDefault=function(t,e,r){return this.get(t,e,r)},t.prototype.get=function(t,e,r){for(var n=this.tree,i=void 0!==r?r:t.length,o=0;o<i;o++){var s=this.mapper(t[o]),a=n[1][s];if(!a){if(!e)return;a=[void 0,{}],n[1][s]=a}n=a}return e&&!n[0]&&(n[0]=e()),n[0]},t.prototype.delete=function(t){for(var e=this.tree,r=0;r<t.length-1;r++){var n=e[1][this.mapper(t[r])];if(!n)return;e=n}delete e[1][this.mapper(t[t.length-1])]},t}(),xt=function(){function t(){this.namespaceTree=new _t((function(t){return t.scope})),this.namespaceByElement=new Map,this.vnodesBeingRemoved=[]}return t.prototype.setEventDelegator=function(t){this.eventDelegator=t},t.prototype.insertElement=function(t,e){this.namespaceByElement.set(e,t),this.namespaceTree.set(t,e)},t.prototype.removeElement=function(t){this.namespaceByElement.delete(t);var e=this.getNamespace(t);e&&this.namespaceTree.delete(e)},t.prototype.getElement=function(t,e){return this.namespaceTree.get(t,void 0,e)},t.prototype.getRootElement=function(t){if(this.namespaceByElement.has(t))return t;for(var e=t;!this.namespaceByElement.has(e);){if(!(e=e.parentNode))return;if("HTML"===e.tagName)throw new Error("No root element found, this should not happen at all")}return e},t.prototype.getNamespace=function(t){var e=this.getRootElement(t);if(e)return this.namespaceByElement.get(e)},t.prototype.createModule=function(){var t=this;return{create:function(e,r){var n=r.elm,i=r.data,o=(void 0===i?{}:i).isolate;Array.isArray(o)&&t.insertElement(o,n)},update:function(e,r){var n=e.elm,i=e.data,o=void 0===i?{}:i,s=r.elm,a=r.data,u=void 0===a?{}:a,c=o.isolate,l=u.isolate;x(c,l)||Array.isArray(c)&&t.removeElement(n),Array.isArray(l)&&t.insertElement(l,s)},destroy:function(e){t.vnodesBeingRemoved.push(e)},remove:function(e,r){t.vnodesBeingRemoved.push(e),r()},post:function(){for(var e=t.vnodesBeingRemoved,r=e.length-1;r>=0;r--){var n=e[r],i=void 0!==n.data?n.data.isolation:void 0;void 0!==i&&t.removeElement(i),t.eventDelegator.removeElement(n.elm,i)}t.vnodesBeingRemoved=[]}}},t}(),wt=function(){function t(){this.arr=[],this.prios=[]}return t.prototype.add=function(t,e){for(var r=0;r<this.arr.length;r++)if(this.prios[r]<e)return this.arr.splice(r,0,t),void this.prios.splice(r,0,e);this.arr.push(t),this.prios.push(e)},t.prototype.forEach=function(t){for(var e=0;e<this.arr.length;e++)t(this.arr[e],e,this.arr)},t.prototype.delete=function(t){for(var e=0;e<this.arr.length;e++)if(this.arr[e]===t)return this.arr.splice(e,1),void this.prios.splice(e,1)},t}(),Ot=function(){return(Ot=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Mt=["blur","canplay","canplaythrough","durationchange","emptied","ended","focus","load","loadeddata","loadedmetadata","mouseenter","mouseleave","pause","play","playing","ratechange","reset","scroll","seeked","seeking","stalled","submit","suspend","timeupdate","unload","volumechange","waiting"],Et=function(){function t(t,e){var r=this;this.rootElement$=t,this.isolateModule=e,this.virtualListeners=new _t((function(t){return t.scope})),this.nonBubblingListenersToAdd=new Set,this.virtualNonBubblingListener=[],this.isolateModule.setEventDelegator(this),this.domListeners=new Map,this.domListenersToAdd=new Map,this.nonBubblingListeners=new Map,t.addListener({next:function(t){r.origin!==t&&(r.origin=t,r.resetEventListeners(),r.domListenersToAdd.forEach((function(t,e){return r.setupDOMListener(e,t)})),r.domListenersToAdd.clear()),r.nonBubblingListenersToAdd.forEach((function(t){r.setupNonBubblingListener(t)}))}})}return t.prototype.addEventListener=function(t,e,r,n){var o,s=i.a.never(),a=new w(e,this.isolateModule);if(void 0===n?-1===Mt.indexOf(t):n)return this.domListeners.has(t)||this.setupDOMListener(t,!!r.passive),o=this.insertListener(s,a,t,r),s;var u=[];this.nonBubblingListenersToAdd.forEach((function(t){return u.push(t)}));for(var c=void 0,l=0,f=u.length,h=function(r){r[0];var n=r[1],i=r[2];r[3];return t===n&&x(i.namespace,e)};!c&&l<f;){var p=u[l];c=h(p)?p:c,l++}var d,m=c;if(m){var y=m[0];d=y}else{var v=new O(e,this.isolateModule);o=this.insertListener(s,a,t,r),m=[s,t,v,o],d=s,this.nonBubblingListenersToAdd.add(m),this.setupNonBubblingListener(m)}var g=this,b=null;return i.a.create({start:function(t){b=d.subscribe(t)},stop:function(){m[0];var t=m[1],e=m[2];m[3];e.call().forEach((function(e){var r=e.subs;r&&r[t]&&(r[t].unsubscribe(),delete r[t])})),g.nonBubblingListenersToAdd.delete(m),b.unsubscribe()}})},t.prototype.removeElement=function(t,e){void 0!==e&&this.virtualListeners.delete(e);var r=[];this.nonBubblingListeners.forEach((function(e,n){if(e.has(t)){r.push([n,t]);var i=t.subs;i&&Object.keys(i).forEach((function(t){i[t].unsubscribe()}))}}));for(var n=0;n<r.length;n++){var i=this.nonBubblingListeners.get(r[n][0]);i&&(i.delete(r[n][1]),0===i.size?this.nonBubblingListeners.delete(r[n][0]):this.nonBubblingListeners.set(r[n][0],i))}},t.prototype.insertListener=function(t,e,r,n){var i=[],o=e._namespace,s=o.length;do{i.push(this.getVirtualListeners(r,o,!0,s)),s--}while(s>=0&&"total"!==o[s].type);for(var a=Ot({},n,{scopeChecker:e,subject:t,bubbles:!!n.bubbles,useCapture:!!n.useCapture,passive:!!n.passive}),u=0;u<i.length;u++)i[u].add(a,o.length);return a},t.prototype.getVirtualListeners=function(t,e,r,n){void 0===r&&(r=!1);var i=void 0!==n?n:e.length;if(!r)for(var o=i-1;o>=0;o--){if("total"===e[o].type){i=o+1;break}i=o}var s=this.virtualListeners.getDefault(e,(function(){return new Map}),i);return s.has(t)||s.set(t,new wt),s.get(t)},t.prototype.setupDOMListener=function(t,e){var r=this;if(this.origin){var n=m(this.origin,t,!1,!1,e).subscribe({next:function(n){return r.onEvent(t,n,e)},error:function(){},complete:function(){}});this.domListeners.set(t,{sub:n,passive:e})}else this.domListenersToAdd.set(t,e)},t.prototype.setupNonBubblingListener=function(t){t[0];var e=t[1],r=t[2],n=t[3];if(this.origin){var i=r.call();if(i.length){var o=this;i.forEach((function(t){var r,i=t.subs;if(!i||!i[e]){var s=m(t,e,!1,!1,n.passive).subscribe({next:function(t){return o.onEvent(e,t,!!n.passive,!1)},error:function(){},complete:function(){}});o.nonBubblingListeners.has(e)||o.nonBubblingListeners.set(e,new Map);var a=o.nonBubblingListeners.get(e);if(!a)return;a.set(t,{sub:s,destination:n}),t.subs=Ot({},i,((r={})[e]=s,r))}}))}}},t.prototype.resetEventListeners=function(){for(var t=this.domListeners.entries(),e=t.next();!e.done;){var r=e.value,n=r[0],i=r[1],o=i.sub,s=i.passive;o.unsubscribe(),this.setupDOMListener(n,s),e=t.next()}},t.prototype.putNonBubblingListener=function(t,e,r,n){var i=this.nonBubblingListeners.get(t);if(i){var o=i.get(e);o&&o.destination.passive===n&&o.destination.useCapture===r&&(this.virtualNonBubblingListener[0]=o.destination)}},t.prototype.onEvent=function(t,e,r,n){void 0===n&&(n=!0);var i=this.patchEvent(e),o=this.isolateModule.getRootElement(e.target);if(n){var s=this.isolateModule.getNamespace(e.target);if(!s)return;var a=this.getVirtualListeners(t,s);this.bubble(t,e.target,o,i,a,s,s.length-1,!0,r),this.bubble(t,e.target,o,i,a,s,s.length-1,!1,r)}else this.putNonBubblingListener(t,e.target,!0,r),this.doBubbleStep(t,e.target,o,i,this.virtualNonBubblingListener,!0,r),this.putNonBubblingListener(t,e.target,!1,r),this.doBubbleStep(t,e.target,o,i,this.virtualNonBubblingListener,!1,r),e.stopPropagation()},t.prototype.bubble=function(t,e,r,n,i,o,s,a,u){a||n.propagationHasBeenStopped||this.doBubbleStep(t,e,r,n,i,a,u);var c=r,l=s;if(e===r){if(!(s>=0&&"sibling"===o[s].type))return;c=this.isolateModule.getElement(o,s),l--}e.parentNode&&c&&this.bubble(t,e.parentNode,c,n,i,o,l,a,u),a&&!n.propagationHasBeenStopped&&this.doBubbleStep(t,e,r,n,i,a,u)},t.prototype.doBubbleStep=function(t,e,r,n,i,o,s){r&&(this.mutateEventCurrentTarget(n,e),i.forEach((function(t){if(t.passive===s&&t.useCapture===o){var i=_(t.scopeChecker.namespace);!n.propagationHasBeenStopped&&t.scopeChecker.isDirectlyInScope(e)&&(""!==i&&e.matches(i)||""===i&&e===r)&&(y(n,t.preventDefault),t.subject.shamefullySendNext(n))}})))},t.prototype.patchEvent=function(t){var e=t;e.propagationHasBeenStopped=!1;var r=e.stopPropagation;return e.stopPropagation=function(){r.call(this),this.propagationHasBeenStopped=!0},e},t.prototype.mutateEventCurrentTarget=function(t,e){try{Object.defineProperty(t,"currentTarget",{value:e,configurable:!0})}catch(t){console.log("please use event.ownerTarget")}t.ownerTarget=e},t}();function jt(t){return i.a.merge(t,i.a.never())}function St(t){return t.elm}function kt(t){(console.error||console.log)(t)}function At(t,e){void 0===e&&(e={}),b(t);var r=e.modules||bt;!function(t){if(!Array.isArray(t))throw new Error("Optional modules option must be an array for snabbdom modules")}(r);var n,o,s=new xt,a=R([s.createModule()].concat(r)),u=i.a.create({start:function(t){"loading"===document.readyState?document.addEventListener("readystatechange",(function(){var e=document.readyState;"interactive"!==e&&"complete"!==e||(t.next(null),t.complete())})):(t.next(null),t.complete())},stop:function(){}}),c=i.a.create({start:function(t){o=new MutationObserver((function(){return t.next(null)}))},stop:function(){o.disconnect()}});return function(r,l){void 0===l&&(l="DOM"),function(t){if(!t||"function"!=typeof t.addListener||"function"!=typeof t.fold)throw new Error("The DOM driver function expects as input a Stream of virtual DOM elements")}(r);var f=i.a.create(),h=u.map((function(){var e=function(t){var e="string"==typeof t?document.querySelector(t):t;if("string"==typeof t&&null===e)throw new Error("Cannot render into unknown element `"+t+"`");return e}(t)||document.body;return n=new ut(e),e})),p=r.remember();p.addListener({}),c.addListener({});var d=h.map((function(t){return i.a.merge(p.endWhen(f),f).map((function(t){return n.call(t)})).startWith((e=Object(G.toVNode)(t),e.data=e.data||{},e.data.isolate=[],e)).fold(a,Object(G.toVNode)(t)).drop(1).map(St).startWith(t).map((function(t){return o.observe(t,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),t})).compose(jt);var e})).flatten(),m=F()(u,c).endWhen(f).compose(z()(d)).map((function(t){return t[1]})).remember();m.addListener({error:e.reportSnabbdomError||kt});var y=new Et(m,s);return new j(m,f,[],s,y,l)}}!function(){function t(t){this._mockConfig=t,t.elements?this._elements=t.elements:this._elements=Object(d.adapt)(i.a.empty())}t.prototype.elements=function(){var t=this._elements;return t._isCycleSource="MockedDOM",t},t.prototype.element=function(){var t=this.elements().filter((function(t){return t.length>0})).map((function(t){return t[0]})).remember(),e=Object(d.adapt)(t);return e._isCycleSource="MockedDOM",e},t.prototype.events=function(t,e,r){var n=this._mockConfig[t],o=Object(d.adapt)(n||i.a.empty());return o._isCycleSource="MockedDOM",o},t.prototype.select=function(e){return new t(this._mockConfig[e]||{})},t.prototype.isolateSource=function(t,e){return t.select(".___"+e)},t.prototype.isolateSink=function(t,e){return Object(d.adapt)(i.a.fromObservable(t).map((function(t){return t.sel&&-1!==t.sel.indexOf("___"+e)||(t.sel+=".___"+e),t})))}}();function Tt(t){return function(t){return"string"==typeof t&&t.length>0}(t)&&("."===t[0]||"#"===t[0])}function Ct(t){return function(e,r,n){var i=void 0!==e,o=void 0!==r,s=void 0!==n;return Tt(e)?o&&s?Object(p.h)(t+e,r,n):o?Object(p.h)(t+e,r):Object(p.h)(t+e,{}):s?Object(p.h)(t+e,r,n):o?Object(p.h)(t,e,r):i?Object(p.h)(t,e):Object(p.h)(t,{})}}var Dt=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","colorProfile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotlight","feTile","feTurbulence","filter","font","fontFace","fontFaceFormat","fontFaceName","fontFaceSrc","fontFaceUri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missingGlyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Pt=Ct("svg");Dt.forEach((function(t){Pt[t]=Ct(t)}));var Nt=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","meta","nav","noscript","object","ol","optgroup","option","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","video"],It={SVG_TAG_NAMES:Dt,TAG_NAMES:Nt,svg:Pt,isSelector:Tt,createTagFunction:Ct};Nt.forEach((function(t){It[t]=Ct(t)}));var Lt=It,Bt=(Lt.svg,Lt.a,Lt.abbr,Lt.address,Lt.area,Lt.article,Lt.aside,Lt.audio,Lt.b,Lt.base,Lt.bdi,Lt.bdo,Lt.blockquote,Lt.body,Lt.br,Lt.button,Lt.canvas),Rt=(Lt.caption,Lt.cite,Lt.code,Lt.col,Lt.colgroup,Lt.dd,Lt.del,Lt.dfn,Lt.dir,Lt.div),$t=(Lt.dl,Lt.dt,Lt.em,Lt.embed,Lt.fieldset,Lt.figcaption,Lt.figure,Lt.footer,Lt.form,Lt.h1,Lt.h2,Lt.h3,Lt.h4,Lt.h5,Lt.h6,Lt.head,Lt.header,Lt.hgroup,Lt.hr,Lt.html,Lt.i,Lt.iframe,Lt.img,Lt.input),Ft=(Lt.ins,Lt.kbd,Lt.keygen,Lt.label,Lt.legend,Lt.li,Lt.link,Lt.main,Lt.map,Lt.mark,Lt.menu,Lt.meta,Lt.nav,Lt.noscript,Lt.object,Lt.ol,Lt.optgroup,Lt.option),Wt=(Lt.p,Lt.param,Lt.pre,Lt.progress,Lt.q,Lt.rp,Lt.rt,Lt.ruby,Lt.s,Lt.samp,Lt.script,Lt.section,Lt.select),zt=(Lt.small,Lt.source,Lt.span),Gt=(Lt.strong,Lt.style,Lt.sub,Lt.sup,Lt.table,Lt.tbody,Lt.td,Lt.textarea,Lt.tfoot,Lt.th,Lt.thead,Lt.title,Lt.tr,Lt.u,Lt.ul,Lt.video);const Ut={main:{position:"absolute",left:0,top:0,width:"50px",height:"50px",background:"#000",zIndex:9999,color:"white",fontSize:"20px",fontWeight:700,borderRadius:"0 0 50px 0",boxSizing:"border-box",cursor:"pointer",transition:"all 100ms ease-in",padding:"0 0 0 0"},active:{position:"absolute",left:0,top:0,width:"50px",height:"50px",background:"#000",zIndex:9999,color:"white",fontSize:"20px",fontWeight:700,borderRadius:"0 0 50px 0",boxSizing:"border-box",cursor:"pointer",transition:"all 100ms ease-in",padding:"6px 0 0 0"}},qt={display:"none"},Vt={position:"absolute",top:0,left:0,zIndex:100},Ht={main:{position:"absolute",top:0,left:"-110vw",transition:"all 500ms ease-in-out",zIndex:999},active:{position:"absolute",top:0,left:0,transition:"all 500ms ease-in-out",zIndex:999}},Xt={position:"relative",float:"left",clear:"both",borderRadius:"0 0 0.5em 0",borderBottom:"4px solid #FFF"},Kt={position:"absolute",top:0,left:0,borderRadius:"0 0 0.5em 0"},Zt={position:"relative",float:"left",clear:"both",margin:"1em 0 1em 0em",padding:"1em 1.5em 1em 1.5em",background:"black",borderRadius:"0 0.5em 0.5em 0",borderBottom:"4px solid #FFF",width:"23em"},Yt={position:"relative",float:"left",clear:"both",margin:"0.25em 0 0.25em 0",width:"100%"},Jt={position:"relative",float:"left",fontWeight:600,color:"white"},Qt={position:"relative",float:"right"};function te(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ee(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ee(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}const re=[{width:320,height:240},{width:640,height:480},{width:1280,height:720},{width:1920,height:1080}];let ne;const ie=[];var oe=function(t,e){const r=t.config.map(t=>t.camera_params.rearCamera).take(2),n=i.a.combine(e.videoSize$,e.camID$,r).map(t=>i.a.fromPromise(function(t){let e=te(t,3),r=e[0],n=e[1],i=e[2];const o=re[r];return ne&&ne.getTracks().forEach(t=>{t.stop()}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise((function(r,n){e.call(navigator,t,r,n)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia({video:{width:o.width,height:o.height,deviceId:0===n||i?{}:{exact:n},facingMode:i?{exact:"environment"}:{}}})}(t))).flatten(),o=i.a.of(Gt("#beholder-video",{attrs:{autoplay:!0},style:{display:"none"}}));return i.a.combine(t.DOM.select("#beholder-video").element(),n,e.torch$).subscribe({next:t=>{let e=te(t,3),r=e[0],n=e[1],i=e[2];if("srcObject"in r?r.srcObject=n:r.src=window.URL.createObjectURL(n),ne=n,ie.forEach(t=>t(ne)),i)if(ImageCapture){const t=n.getVideoTracks()[0];new ImageCapture(t).getPhotoCapabilities().then(()=>{void 0!==t.getCapabilities().torch&&t.applyConstraints({advanced:[{torch:i}]})})}else console.warn("BEHOLDER WARNS: Flahslight/Torch functionality is not supported on this device or platform")},error:t=>console.log(t)}),{vdom$:o}},se=se||{};se.Image=function(t,e,r){this.width=t||0,this.height=e||0,this.data=r||[]},se.grayscale=function(t,e){for(var r=t.data,n=e.data,i=r.length,o=0,s=0;o<i;o+=4)n[s++]=.299*r[o]+.587*r[o+1]+.114*r[o+2]+.5&255;return e.width=t.width,e.height=t.height,e},se.threshold=function(t,e,r){var n,i=t.data,o=e.data,s=i.length,a=[];for(n=0;n<256;++n)a[n]=n<=r?0:255;for(n=0;n<s;++n)o[n]=a[i[n]];return e.width=t.width,e.height=t.height,e},se.adaptiveThreshold=function(t,e,r,n){var i,o=t.data,s=e.data,a=o.length,u=[];for(se.stackBoxBlur(t,e,r),i=0;i<768;++i)u[i]=i-255<=-n?255:0;for(i=0;i<a;++i)s[i]=u[o[i]-s[i]+255];return e.width=t.width,e.height=t.height,e},se.otsu=function(t){var e,r,n,i=t.data,o=i.length,s=[],a=0,u=0,c=0,l=0,f=0,h=0;for(n=0;n<256;++n)s[n]=0;for(n=0;n<o;++n)s[i[n]]++;for(n=0;n<256;++n)u+=s[n]*n;for(n=0;n<256;++n)if(0!==(l+=s[n])){if(0===(f=o-l))break;(r=l*f*(e=(c+=s[n]*n)/l-(u-c)/f)*e)>h&&(h=r,a=n)}return a},se.stackBoxBlurMult=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265],se.stackBoxBlurShift=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13],se.BlurStack=function(){this.color=0,this.next=null},se.stackBoxBlur=function(t,e,r){var n,i,o,s,a,u,c,l,f,h,p=t.data,d=e.data,m=t.height,y=t.width,v=m-1,g=y-1,b=r+r+1,_=r+1,x=se.stackBoxBlurMult[r],w=se.stackBoxBlurShift[r];for(n=i=new se.BlurStack,h=1;h<b;++h)n=n.next=new se.BlurStack;for(n.next=i,a=0,f=0;f<m;++f){for(u=a,s=_*(o=p[a]),n=i,h=0;h<_;++h)n.color=o,n=n.next;for(h=1;h<_;++h)n.color=p[a+h],s+=n.color,n=n.next;for(n=i,l=0;l<y;++l)d[a++]=s*x>>>w,c=u+((c=l+_)<g?c:g),s-=n.color-p[c],n.color=p[c],n=n.next}for(l=0;l<y;++l){for(u=(a=l)+y,s=_*(o=d[a]),n=i,h=0;h<_;++h)n.color=o,n=n.next;for(h=1;h<_;++h)n.color=d[u],s+=n.color,n=n.next,u+=y;for(n=i,f=0;f<m;++f)d[a]=s*x>>>w,c=l+((c=f+_)<v?c:v)*y,s-=n.color-d[c],n.color=d[c],n=n.next,a+=y}return e},se.gaussianBlur=function(t,e,r,n){var i=se.gaussianKernel(n);return e.width=t.width,e.height=t.height,r.width=t.width,r.height=t.height,se.gaussianBlurFilter(t,r,i,!0),se.gaussianBlurFilter(r,e,i,!1),e},se.findContours=function(t,e){var r,n,i,o,s,a,u,c,l,f=t.width,h=t.height,p=[];for(r=se.binaryBorder(t,e),n=se.neighborhoodDeltas(f+2),i=f+3,s=1,c=0;c<h;++c,i+=2)for(l=0;l<f;++l,++i)0!==(o=r[i])&&(a=u=!1,1===o&&0===r[i-1]?a=!0:o>=1&&0===r[i+1]&&(u=!0),(a||u)&&(++s,p.push(se.borderFollowing(r,i,s,{x:l,y:c},u,n))));return p},se.borderFollowing=function(t,e,r,n,i,o){var s,a,u,c,l,f=[];f.hole=i,c=l=i?0:4;do{if(0!==t[s=e+o[c=c-1&7]])break}while(c!==l);if(c===l)t[e]=-r,f.push({x:n.x,y:n.y});else for(a=e,4^c;;){l=c;do{u=a+o[++c]}while(0===t[u]);if((c&=7)-1>>>0<l>>>0?t[a]=-r:1===t[a]&&(t[a]=r),f.push({x:n.x,y:n.y}),c,n.x+=se.neighborhood[c][0],n.y+=se.neighborhood[c][1],u===e&&a===s)break;a=u,c=c+4&7}return f},se.neighborhood=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]],se.neighborhoodDeltas=function(t){for(var e=[],r=se.neighborhood.length,n=0;n<r;++n)e[n]=se.neighborhood[n][0]+se.neighborhood[n][1]*t;return e.concat(e)},se.approxPolyDP=function(t,e){var r,n,i,o,s,a,u,c,l,f,h,p={start_index:0,end_index:0},d={start_index:0,end_index:0},m=[],y=[],v=t.length;for(e*=e,h=0,l=0;l<3;++l)for(s=0,n=t[h=(h+d.start_index)%v],++h===v&&(h=0),f=1;f<v;++f)r=t[h],++h===v&&(h=0),(o=(u=r.x-n.x)*u+(c=r.y-n.y)*c)>s&&(s=o,d.start_index=f);for(s<=e?m.push({x:n.x,y:n.y}):(p.start_index=h,p.end_index=d.start_index+=p.start_index,d.start_index-=d.start_index>=v?v:0,d.end_index=p.start_index,d.end_index<d.start_index&&(d.end_index+=v),y.push({start_index:d.start_index,end_index:d.end_index}),y.push({start_index:p.start_index,end_index:p.end_index}));0!==y.length;){if(i=t[(p=y.pop()).end_index%v],n=t[h=p.start_index%v],++h===v&&(h=0),p.end_index<=p.start_index+1)a=!0;else{for(s=0,u=i.x-n.x,c=i.y-n.y,l=p.start_index+1;l<p.end_index;++l)r=t[h],++h===v&&(h=0),(o=Math.abs((r.y-n.y)*u-(r.x-n.x)*c))>s&&(s=o,d.start_index=l);a=s*s<=e*(u*u+c*c)}a?m.push({x:n.x,y:n.y}):(d.end_index=p.end_index,p.end_index=d.start_index,y.push({start_index:d.start_index,end_index:d.end_index}),y.push({start_index:p.start_index,end_index:p.end_index}))}return m},se.warp=function(t,e,r,n){var i,o,s,a,u,c,l,f,h,p,d,m,y,v,g,b,_,x,w,O,M,E,j=t.data,S=e.data,k=t.width,A=t.height,T=0;for(y=(m=se.getPerspectiveTransform(r,n-1))[8],v=m[2],g=m[5],M=0;M<n;++M)for(b=y+=m[7],_=v+=m[1],x=g+=m[4],E=0;E<n;++E)b+=m[6],o=(i=(w=(_+=m[0])/b)>>>0)===k-1?i:i+1,a=1-(s=w-i),l=1-(c=(O=(x+=m[3])/b)-(u=O>>>0)),f=h=u*k,p=d=(u===A-1?u:u+1)*k,S[T++]=l*(a*j[f+i]+s*j[h+o])+c*(a*j[p+i]+s*j[d+o])&255;return e.width=n,e.height=n,e},se.getPerspectiveTransform=function(t,e){var r=se.square2quad(t);return r[0]/=e,r[1]/=e,r[3]/=e,r[4]/=e,r[6]/=e,r[7]/=e,r},se.square2quad=function(t){var e,r,n,i,o,s,a,u=[];return e=t[0].x-t[1].x+t[2].x-t[3].x,r=t[0].y-t[1].y+t[2].y-t[3].y,0===e&&0===r?(u[0]=t[1].x-t[0].x,u[1]=t[2].x-t[1].x,u[2]=t[0].x,u[3]=t[1].y-t[0].y,u[4]=t[2].y-t[1].y,u[5]=t[0].y,u[6]=0,u[7]=0,u[8]=1):(n=t[1].x-t[2].x,i=t[3].x-t[2].x,o=t[1].y-t[2].y,a=n*(s=t[3].y-t[2].y)-i*o,u[6]=(e*s-i*r)/a,u[7]=(n*r-e*o)/a,u[8]=1,u[0]=t[1].x-t[0].x+u[6]*t[1].x,u[1]=t[3].x-t[0].x+u[7]*t[3].x,u[2]=t[0].x,u[3]=t[1].y-t[0].y+u[6]*t[1].y,u[4]=t[3].y-t[0].y+u[7]*t[3].y,u[5]=t[0].y),u},se.isContourConvex=function(t){var e,r,n,i,o,s,a,u,c=0,l=!0,f=t.length,h=0,p=0;for(r=t[f-1],o=(e=t[0]).x-r.x,s=e.y-r.y;h<f;++h){if(++p===f&&(p=0),r=e,a=(e=t[p]).x-r.x,3===(c|=(i=(u=e.y-r.y)*o)>(n=a*s)?1:i<n?2:3)){l=!1;break}o=a,s=u}return l},se.perimeter=function(t){for(var e,r,n=t.length,i=0,o=n-1,s=0;i<n;o=i++)e=t[i].x-t[o].x,r=t[i].y-t[o].y,s+=Math.sqrt(e*e+r*r);return s},se.minEdgeLength=function(t){for(var e,r,n,i=t.length,o=0,s=i-1,a=1/0;o<i;s=o++)(e=(r=t[o].x-t[s].x)*r+(n=t[o].y-t[s].y)*n)<a&&(a=e);return Math.sqrt(a)},se.countNonZero=function(t,e){var r,n,i=t.data,o=e.height,s=e.width,a=e.x+e.y*t.width,u=t.width-s,c=0;for(r=0;r<o;++r){for(n=0;n<s;++n)0!==i[a++]&&++c;a+=u}return c},se.binaryBorder=function(t,e){var r,n,i=t.data,o=t.height,s=t.width,a=0,u=0;for(n=-2;n<s;++n)e[u++]=0;for(r=0;r<o;++r){for(e[u++]=0,n=0;n<s;++n)e[u++]=0===i[a++]?0:1;e[u++]=0}for(n=-2;n<s;++n)e[u++]=0;return e};var ae=se;function ue(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ce(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(r),!0).forEach((function(e){le(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function le(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const fe={};let he={MIN_MARKER_DISTANCE:10,MIN_MARKER_PERIMETER:.2,MAX_MARKER_PERIMETER:.8,SIZE_AFTER_PERSPECTIVE_REMOVAL:49};fe.setCameraParams=t=>{he=ce(ce({},he),t)},fe.Marker=(t,e)=>{const r=(e[0].y-e[2].y)/(e[0].x-e[2].x),n=(e[1].y-e[3].y)/(e[1].x-e[3].x),i={x:0,y:0};return i.x=function(t,e,r,n){return(r.y-n.y+e*n.x-t*r.x)/(e-t)}(r,n,e[0],e[1]),i.y=function(t,e,r){return e*(r-t.x)+t.y}(e[0],r,i.x),{id:t,corners:e,center:i}},fe.Detector=function(){this.grey=new ae.Image,this.thres=new ae.Image,this.homography=new ae.Image,this.binary=[],this.contours=[],this.polys=[],this.candidates=[]},fe.Detector.prototype.detect=function(t,e){return ae.grayscale(t,this.grey),ae.adaptiveThreshold(this.grey,this.thres,2,7),this.contours=ae.findContours(this.thres,this.binary),this.candidates=this.findCandidates(this.contours,t.width*e.minMarkerPerimeter,t.width*e.maxMarkerPerimeter,.05,10),this.candidates=this.clockwiseCorners(this.candidates),this.candidates=this.notTooNear(this.candidates,e.minMarkerDistance),this.findMarkers(this.grey,this.candidates,e.sizeAfterPerspectiveRemoval)},fe.Detector.prototype.findCandidates=function(t,e,r,n,i){var o,s,a,u=[],c=t.length;for(this.polys=[],a=0;a<c;++a)(o=t[a]).length>=e&&o.length<=r&&(s=ae.approxPolyDP(o,o.length*n),this.polys.push(s),4===s.length&&ae.isContourConvex(s)&&ae.minEdgeLength(s)>=i&&u.push(s));return u},fe.Detector.prototype.clockwiseCorners=function(t){var e,r,n,i,o,s=t.length;for(o=0;o<s;++o)e=t[o][1].x-t[o][0].x,n=t[o][1].y-t[o][0].y,r=t[o][2].x-t[o][0].x,e*(t[o][2].y-t[o][0].y)-n*r<0&&(i=t[o][1],t[o][1]=t[o][3],t[o][3]=i);return t},fe.Detector.prototype.notTooNear=function(t,e){var r,n,i,o,s,a,u=[],c=t.length;for(o=0;o<c;++o)for(s=o+1;s<c;++s){for(r=0,a=0;a<4;++a)r+=(n=t[o][a].x-t[s][a].x)*n+(i=t[o][a].y-t[s][a].y)*i;r/4<e*e&&(ae.perimeter(t[o])<ae.perimeter(t[s])?t[o].tooNear=!0:t[s].tooNear=!0)}for(o=0;o<c;++o)t[o].tooNear||u.push(t[o]);return u},fe.Detector.prototype.findMarkers=function(t,e,r){var n,i,o,s=[],a=e.length;for(o=0;o<a;++o)n=e[o],ae.warp(t,this.homography,n,r),ae.threshold(this.homography,this.homography,ae.otsu(this.homography)),(i=this.getMarker(this.homography,n))&&s.push(i);return s},fe.Detector.prototype.getMarker=function(t,e){var r,n,i,o,s,a=t.width/7>>>0,u=a*a>>1,c=[],l=[],f=[];for(o=0;o<7;++o)for(i=0===o||6===o?1:6,s=0;s<7;s+=i)if(r={x:s*a,y:o*a,width:a,height:a},ae.countNonZero(t,r)>u)return null;for(o=0;o<5;++o)for(c[o]=[],s=0;s<5;++s)r={x:(s+1)*a,y:(o+1)*a,width:a,height:a},c[o][s]=ae.countNonZero(t,r)>u?1:0;for(l[0]=c,f[0]=this.hammingDistance(l[0]),n={first:f[0],second:0},o=1;o<4;++o)l[o]=this.rotate(l[o-1]),f[o]=this.hammingDistance(l[o]),f[o]<n.first&&(n.first=f[o],n.second=o);return 0!==n.first?null:fe.Marker(this.mat2id(l[n.second]),this.rotate2(e,4-n.second))},fe.Detector.prototype.hammingDistance=function(t){var e,r,n,i,o,s=[[1,0,0,0,0],[1,0,1,1,1],[0,1,0,0,1],[0,1,1,1,0]],a=0;for(n=0;n<5;++n){for(r=1/0,i=0;i<4;++i){for(e=0,o=0;o<5;++o)e+=t[n][o]===s[i][o]?0:1;e<r&&(r=e)}a+=r}return a},fe.Detector.prototype.mat2id=function(t){var e,r=0;for(e=0;e<5;++e)r<<=1,r|=t[e][1],r<<=1,r|=t[e][3];return r},fe.Detector.prototype.rotate=function(t){var e,r,n=[],i=t.length;for(e=0;e<i;++e)for(n[e]=[],r=0;r<t[e].length;++r)n[e][r]=t[t[e].length-r-1][e];return n},fe.Detector.prototype.rotate2=function(t,e){var r,n=[],i=t.length;for(r=0;r<i;++r)n[r]=t[(e+r)%i];return n};var pe=fe;function de(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return me(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return me(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ye(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ve(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ye(Object(r),!0).forEach((function(e){ge(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ge(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}let be={CAMERA_INFO:{},VIDEO_SIZE:{width:{exact:640},height:{exact:480}},minMarkerDistance:10,minMarkerPerimeter:.02,maxMarkerPerimeter:.8,sizeAfterPerspectiveRemoval:49};var _e=function(t){const e=t.DOM.select("#detection-canvas").element(),r=e.map(t=>t.getContext("2d")),n=t.DOM.select("#beholder-video").element(),o=t.update,s=new pe.Detector;return t.config.subscribe({next:t=>{be=ve(ve({},be),t.detection_params)}}),{marker$:i.a.combine(e,r,o,n).compose(z()(t.config)).map(t=>{let e=de(t,2),r=e[0],n=e[1].feed_params;const i=de(r,4),o=i[0],a=i[1],u=i[2],c=i[3];if(c.readyState===c.HAVE_ENOUGH_DATA){a.filter=`contrast(${(100+Math.floor(n.contrast))/100})\n         brightness(${(100+Math.floor(n.brightness))/100})\n         grayscale(${Math.floor(n.grayscale)/100})`,n.flip?(a.save(),a.translate(o.width,0),a.scale(-1,1),a.drawImage(c,0,0,o.width,o.height),a.restore()):a.drawImage(c,0,0,o.width,o.height);let t=a.getImageData(0,0,o.width,o.height);return[s.detect(t,be),u]}return[[],u]})}};class xe{static sub(t,e){return new xe(e.x-t.x,e.y-t.y)}static fromAngle(t){return new xe(Math.cos(t),Math.sin(t))}static add(t,e){return new xe(e.x+t.x,e.y+t.y)}static addScalar(t,e,r){const n=t.x+e.x*r,i=t.y+e.y*r;return new xe(n,i)}static mag(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static angleBetween(t,e){return Math.atan2(t.x*e.y-t.y*e.x,t.x*e.x+t.y*e.y)}static rotate(t,e){const r=t.x*Math.cos(e)-t.y*Math.sin(e),n=t.x*Math.sin(e)+t.y*Math.cos(e);return new xe(r,n)}static scale(t,e){return new xe(t.x*e,t.y*e)}static dist(t,e){return new xe(e.x-t.x,e.y-t.y).mag()}static dist2(t,e){return new xe(e.x-t.x,e.y-t.y).mag2()}static normalize(t){const e=t.mag();return new xe(t.x/e,t.y/e)}static copy(t){return new xe(t.x,t.y)}constructor(t,e){this.x=t,this.y=e}clone(){return new xe(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}set(t,e){return this.x=t,this.y=e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}scale(t){return this.x*=t,this.y*=t,this}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}mag2(){return this.x*this.x+this.y*this.y}dist(t){return xe.sub(this,t).mag()}dist2(t){return xe.sub(this,t).mag2()}normalize(){const t=this.mag();return this.x/=t,this.y/=t,this}getAngle(){return Math.atan2(this.y,this.x)}rotate(t){const e=this.x*Math.cos(t)-this.y*Math.sin(t),r=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=r,this}dot(t){return this.x*t.x+this.y*t.y}}var we=class{constructor(t){this.timeout=50,this.timestamp=this.timeout,this.present=!1,this.center=new xe(0,0),this.corners=[],this.rotation=0,this.scale=29/640,this.enable3D=!1,this.avgPerim=0,this.id=t}setScale(t,e){this.scale=t/e}update(t){this.timestamp=0,this.present=!0,this.center.x=t.center.x,this.center.y=t.center.y,this.corners=t.corners.map(t=>t),this.rotation=xe.angleBetween(xe.sub(this.corners[0],this.corners[1]),new xe(1,0));const e=this.corners.map((t,e,r)=>{const n=t.x-r[(e+1)%r.length].x,i=t.y-r[(e+1)%r.length].y;return Math.sqrt(n*n+i*i)});this.avgPerim=(e[0]+e[1]+e[2]+e[3])/4,this.enable3D&&(this.center.z=this.avgPerim/this.scale)}updatePresence(t){this.timestamp+=t,this.present=!(this.timestamp>=this.timeout)}},Oe=r(1);var Me=class{constructor(t,e){this.markerA=t,this.markerB=e}get isPresent(){return this.markerA.present&&this.markerB.present}get angleBetween(){return this.markerA.rotation-this.markerB.rotation}get distance(){return xe.sub(this.markerA.center,this.markerB.center).mag()}getRelativePosition(t){if(this.isPresent()){const e=[{x:-t/2,y:-t/2},{x:t/2,y:-t/2},{x:t/2,y:t/2},{x:-t/2,y:t/2}],r=function(t,e,r,n,i,o,s,a){const u=Oe.matrix([[i.x,i.y,1,0,0,0,-t.x*i.x,-t.x*i.y],[0,0,0,i.x,i.y,1,-t.y*i.x,-t.y*i.y],[o.x,o.y,1,0,0,0,-e.x*o.x,-e.x*o.y],[0,0,0,o.x,o.y,1,-e.y*o.x,-e.y*o.y],[s.x,s.y,1,0,0,0,-r.x*s.x,-r.x*s.y],[0,0,0,s.x,s.y,1,-r.y*s.x,-r.y*s.y],[a.x,a.y,1,0,0,0,-n.x*a.x,-n.x*a.y],[0,0,0,a.x,a.y,1,-n.y*a.x,-n.y*a.y]]),c=Oe.matrix([[t.x],[t.y],[e.x],[e.y],[r.x],[r.y],[n.x],[n.y]]),l=Oe.lusolve(u,c);return Oe.matrix([[Oe.subset(l,Oe.index(0,0)),Oe.subset(l,Oe.index(1,0)),Oe.subset(l,Oe.index(2,0))],[Oe.subset(l,Oe.index(3,0)),Oe.subset(l,Oe.index(4,0)),Oe.subset(l,Oe.index(5,0))],[Oe.subset(l,Oe.index(6,0)),Oe.subset(l,Oe.index(7,0)),1]])}(this.markerA.corners[0],this.markerA.corners[1],this.markerA.corners[2],this.markerA.corners[3],e[0],e[1],e[2],e[3]),n=Oe.inv(r),i=t=>function(t,e){const r=Oe.matrix([[e.x],[e.y],[1]]),n=Oe.multiply(t,r);return{x:Oe.subset(n,Oe.index(0,0))/Oe.subset(n,Oe.index(2,0)),y:Oe.subset(n,Oe.index(1,0))/Oe.subset(n,Oe.index(2,0))}}(n,t),o=i(this.markerA.center),s=i(this.markerB.center),a=i(this.markerA.corners[0]),u=i(this.markerA.corners[1]),c=i(this.markerB.corners[0]),l=i(this.markerB.corners[1]),f=xe.sub(o,s),h=xe.sub(a,u);return{distance:xe.mag(f),heading:xe.angleBetween(h,f),rotation:xe.angleBetween(h,xe.sub(c,l))}}return{distance:void 0,heading:void 0,rotation:void 0}}};function Ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return je(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return je(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Se(t,e){return Ft({attrs:{value:t.deviceId,label:t.label?t.label:e,selected:0===e}})}var ke=function(t){const e=t.DOM.select(".param-input").events("change").map(t=>[t.target.id,t.target.classList.contains("isCheck")?t.target.checked:t.target.value]),r=i.a.fromPromise(navigator.mediaDevices.enumerateDevices()).map(t=>t.filter(t=>"videoinput"===t.kind)),n=i.a.combine(r,t.config).map(t=>{let e=Ee(t,2),r=e[0],n=e[1];return Rt("#parameters-menu",{style:Zt},[Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Camera Feed ID"),Wt("#CAMERA_INDEX.param-input",{style:Qt},r.map(Se))]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Video Size"),Wt("#camera_params-videoSize.param-input",{style:Qt},[Ft({attrs:{value:0,label:"320 x 240",selected:0===n.camera_params.videoSize}}),Ft({attrs:{value:1,label:"640 x 480",selected:1===n.camera_params.videoSize}}),Ft({attrs:{value:2,label:"1280 x 720",selected:2===n.camera_params.videoSize}}),Ft({attrs:{value:3,label:"1920 x 1080",selected:3===n.camera_params.videoSize}})])]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Min Marker Distance"),$t("#detection_params-minMarkerDistance.param-input",{style:Qt,attrs:{type:"number",name:"MIN_MARKER_DISTANCE",min:1,max:50,value:n.detection_params.minMarkerDistance,step:1}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Min Marker Perimeter"),$t("#detection_params-minMarkerPerimeter.param-input",{style:Qt,attrs:{type:"number",name:"MIN_MARKER_PERIMETER",min:.01,max:.99,value:n.detection_params.minMarkerPerimeter,step:.01}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Max Marker Perimeter"),$t("#detection_params-maxMarkerPerimeter.param-input",{style:Qt,attrs:{type:"number",name:"MAX_MARKER_PERIMETER",min:.01,max:.99,value:n.detection_params.maxMarkerPerimeter,step:.01}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Size After Perspective Removal"),$t("#detection_params-sizeAfterPerspectiveRemoval.param-input",{style:Qt,attrs:{type:"number",name:"SIZE_AFTER_PERSPECTIVE_REMOVAL",min:1,max:200,value:n.detection_params.sizeAfterPerspectiveRemoval,step:1}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Contrast"),$t("#feed_params-contrast.param-input",{style:Qt,attrs:{type:"number",name:"IMAGE_CONTRAST",min:-100,max:100,value:n.feed_params.contrast,step:1}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Brightness"),$t("#feed_params-brightness.param-input",{style:Qt,attrs:{type:"number",name:"IMAGE_BRIGHTNESS",min:-100,max:100,value:n.feed_params.brightness,step:1}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Grayscale"),$t("#feed_params-grayscale.param-input",{style:Qt,attrs:{type:"number",name:"IMAGE_GRAYSCALE",min:0,max:100,value:n.feed_params.grayscale,step:1}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Flip Camera"),$t("#feed_params-flip.param-input.isCheck",{style:Qt,attrs:{type:"checkbox",name:"IMAGE_FLIP",checked:n.feed_params.flip}})]),Rt(".parameter-item",{style:Yt},[zt({style:Jt},"Torch Active"),$t("#camera_params-torch.param-input.isCheck",{style:Qt,attrs:{type:"checkbox",name:"TORCH",checked:n.camera_params.torch}})])])}),o=e.filter(t=>"CAMERA_INDEX"===t[0]).map(t=>t[1]).startWith(0);return{vdom$:n,configUpdate$:e.filter(t=>"CAMERA_INDEX"!==t[0]).map(t=>{let e=Ee(t,2),r=e[0],n=e[1];return t=>{const e=Ee(r.split("-"),2),i=e[0],o=e[1];return t[i][o]="boolean"!=typeof n?parseFloat(n):n,t}}),camID$:o}};function Ae(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Te(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ae(Object(r),!0).forEach((function(e){Ce(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ae(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ce(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function De(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Pe(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pe(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}const Ne=[{width:320,height:240},{width:640,height:480},{width:1280,height:720},{width:1920,height:1080}],Ie=[],Le=t=>{let e=De(t,3),r=e[0],n=e[1],i=e[2];const o=De(r,2),s=o[0],a=o[1];i.clearRect(0,0,n.width,n.height),s.forEach(t=>{const e=Ie.find(e=>e.id===t.id);if(void 0===e)return;e.update(t);const r=t.center,n=t.corners,o=e.rotation;i.strokeStyle="#FF00AA",i.beginPath(),n.forEach((t,e)=>{i.moveTo(t.x,t.y);let r=n[(e+1)%n.length];i.lineTo(r.x,r.y)}),i.stroke(),i.closePath(),i.strokeStyle="blue",i.strokeRect(n[0].x-2,n[0].y-2,4,4),i.strokeStyle="#FF00AA",i.strokeRect(r.x-1,r.y-1,2,2),i.font="12px monospace",i.textAlign="center",i.fillStyle="#FF55AA",i.fillText("ID="+e.id,r.x,r.y-7),i.fillText(o.toFixed(2),r.x,r.y+15)}),Ie.forEach(t=>t.updatePresence(a))};function Be(t){i.a.merge(t.DOM.select("#toggle-screen").events("mouseover").mapTo(!0),t.DOM.select("#toggle-screen").events("mouseout").mapTo(!1)).startWith(!1);const e=t.DOM.select("#toggle-screen").events("click").mapTo(t=>(t.overlay_params.hide=!t.overlay_params.hide,t)),r=t.config.map(t=>t.overlay_params.hide),n=t.config.map(t=>t.overlay_params.present),o=ke(t),a=o.camID$,u=t.config.map(t=>t.camera_params.videoSize).startWith(-1).compose(s.a).filter(t=>{let e=De(t,2);return e[0]!==e[1]}).map(t=>{let e=De(t,2);e[0];return e[1]}).startWith(0),c=t.config.map(t=>t.camera_params.torch).startWith(!1).compose(s.a).filter(t=>{let e=De(t,2);return e[0]!==e[1]}).map(t=>{let e=De(t,2);e[0];return e[1]}).startWith(!1),l=u.map(t=>{const e=Ne[t];return Rt([Bt("#detection-canvas",{style:Xt,attrs:Te({},e)}),Bt("#detection-canvas-overlay",{style:Kt,attrs:Te({},e)})])}),f=oe(t,{videoSize$:u,camID$:a,torch$:c}),h=_e(t),p=i.a.combine(n,r),d=i.a.combine(l,o.vdom$,f.vdom$),m=i.a.combine(p,d).map(t=>{let e=De(t,2),r=De(e[0],2),n=r[0],i=r[1],o=e[1];return Rt("#beholder-overlay",{style:n?Vt:qt},[Rt("#toggle-screen",{style:Ut.main},"⥂"),Rt("#detection-panel",{style:i?Ht.main:Ht.active},o)])}),y=t.DOM.select("#detection-canvas-overlay").element(),v=y.map(t=>t.getContext("2d"));i.a.combine(h.marker$,y,v).subscribe({next:Le});return{DOM:m,config:i.a.merge(o.configUpdate$,e)}}let Re,$e=Date.now();const Fe=()=>i.a.create({start:t=>{Re=()=>{const e=Date.now(),r=e-$e;$e=e,t.next(r)}},stop:()=>{}}),We=()=>{Re()};function ze(t){return t.overlay_params.hide=!0,t}function Ge(t){return t.overlay_params.hide=!1,t}const Ue=i.a.create();const qe={camera_params:{videoSize:1,torch:!1},detection_params:{minMarkerDistance:10,minMarkerPerimeter:.02,maxMarkerPerimeter:.8,sizeAfterPerspectiveRemoval:49},feed_params:{contrast:0,brightness:0,grayscale:0,flip:!1},overlay_params:{present:!0,hide:!0}},Ve=(t,e,r)=>{if(r)r.length<=0&&console.warn("BEHOLDER WARNING: your provided list of markers is empty, no markers will be tracked"),r.forEach(t=>Ie.push(new we(t)));else for(let t=0;t<100;t++)Ie.push(new we(t));let n=qe;e&&(e.camera_params&&(n.camera_params=Te(Te({},n.camera_params),e.camera_params)),e.detection_params&&(n.detection_params=Te(Te({},n.detection_params),e.detection_params)),e.feed_params&&(n.feed_params=Te(Te({},n.feed_params),e.feed_params)),e.overlay_params&&(n.overlay_params=Te(Te({},n.overlay_params),e.overlay_params)));var o;h(Be,{DOM:At(t),update:Fe,config:(o=n,t=>i.a.merge(i.a.of(t=>t),t,Ue).fold((t,e)=>e(t),o))})},He=()=>Ie,Xe=t=>Ie.find(e=>e.id===t),Ke=(t,e)=>{new Me(Ie[t],Ie[e])};e.default={init:Ve,update:We,getMarker:Xe,getMarkerPair:Ke,getAllMarkers:He,hide:()=>{Ue.shamefullySendNext(ze)},show:()=>{Ue.shamefullySendNext(Ge)},addVideoStreamListener:t=>{ie.push(t)}}}])}));